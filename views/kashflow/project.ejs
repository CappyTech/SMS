<div class="container my-5">
    <h1 class="mb-4 text-center">Jobs Dashboard</h1>
    
    <div class="container mb-4">
        <form id="sort-form" method="GET" action="/dashboard/KFproject" class="row align-items-center">
            <div class="col-2">
                <label class="visually-hidden" for="sort">Sort by</label>
                <select name="sort" id="sort" class="form-select">
                    <option value="Number" <%= sortOption === 'Number' ? 'selected' : '' %>>Job Number</option>
                    <option value="Name" <%= sortOption === 'Name' ? 'selected' : '' %>>Name (Aâ€“Z)</option>
                    <option value="Files" <%= sortOption === 'Files' ? 'selected' : '' %>>Number of files in Job</option>
                </select>
            </div>

            <div class="col-8">
                <label class="visually-hidden" for="search">Search</label>
                <input type="text" name="search" id="search" class="form-control" placeholder="Search by name or number..." value="<%= searchQuery %>">
            </div>

            <div class="col-2">
                <button type="submit" class="btn btn-hcs-green w-100">Search</button>
            </div>
        </form>
    </div>


    <!-- Tab navigation -->
    <ul class="nav" id="projectsTab" role="tablist">
        <li class="nav-item p-3">
            <button class="btn btn-warning position-relative active" id="active-projects-tab" data-bs-toggle="tab" data-bs-target="#active-projects" type="button" role="tab" aria-controls="active-projects" aria-selected="true">Active Jobs
                <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill text-bg-secondary">
                    <%= activeProjects.length %>
                </span>
            </button>
        </li>
        <li class="nav-item p-3">
            <button class="btn btn-success position-relative" id="completed-projects-tab" data-bs-toggle="tab" data-bs-target="#completed-projects" type="button" role="tab" aria-controls="completed-projects" aria-selected="false">Completed Jobs
                <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill text-bg-secondary">
                    <%= completedProjects.length %>
                </span>
            </button>
        </li>
        <li class="nav-item p-3" role="presentation">
            <button class="btn btn-secondary position-relative" id="archived-projects-tab" data-bs-toggle="tab" data-bs-target="#archived-projects" type="button" role="tab" aria-controls="archived-projects" aria-selected="false">Archived Jobs
                <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill text-bg-secondary">
                    <%= archivedProjects.length %>
                </span>
            </button>
        </li>
    </ul>

    <!-- Tab content -->
    <div class="tab-content" id="projectsTabContent">
        <!-- Active Projects Tab -->
        <div class="tab-pane fade show active" id="active-projects" role="tabpanel" aria-labelledby="active-projects-tab">
            <div class="mt-4">
                <ul class="list-group">
                    <% activeProjects.forEach(project => { %>
                    <li class="list-group-item">
                        <strong><a href="/kashflow/project/read/<%= project.uuid %>" target="_blank"><%= project.Number %> | <%= project.Name %></a></strong>
                        <small class="text-muted d-block">Files: <%= project.fileCount %></small>
                        <p><%= project.Description %></p>
                    </li>
                    <% }) %>
                </ul>
            </div>
        </div>

        <!-- Completed Projects Tab -->
        <div class="tab-pane fade" id="completed-projects" role="tabpanel" aria-labelledby="completed-projects-tab">
            <div class="mt-4">
                <ul class="list-group">
                    <% completedProjects.forEach(project => { %>
                    <li class="list-group-item">
                        <strong><a href="/kashflow/project/read/<%= project.uuid %>" target="_blank"><%= project.Number %> | <%= project.Name %></a></strong>
                        <small class="text-muted d-block">Files: <%= project.fileCount %></small>
                        <p><%= project.Description %></p>
                    </li>
                    <% }) %>
                </ul>
            </div>
        </div>

        <!-- Archived Projects Tab -->
        <div class="tab-pane fade" id="archived-projects" role="tabpanel" aria-labelledby="archived-projects-tab">
            <div class="mt-4">
                <ul class="list-group">
                    <% archivedProjects.forEach(project => { %>
                    <li class="list-group-item">
                        <strong><a href="/kashflow/project/read/<%= project.uuid %>" target="_blank"><%= project.Number %> | <%= project.Name %></a></strong>
                        <small class="text-muted d-block">Files: <%= project.fileCount %></small>
                        <p><%= project.Description %></p>
                    </li>
                    <% }) %>
                </ul>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const sortSelect = document.getElementById('sort');
        sortSelect.addEventListener('change', function () {
            document.getElementById('sort-form').submit();
        });
    });
</script>