<!-- views/updateSubcontractor.ejs -->
<%- include('../partials/successAlert.ejs') %>
<%- include('../partials/errorAlerts.ejs') %>

<div class="container mt-2">
    <h1>Update Subcontractor</h1>
    <form action="/subcontractor/update/<%= subcontractor.id %>" method="POST">
        <div class="form-floating mb-3">
            <input type="text" name="name" id="name" class="form-control" value="<%= subcontractor.name %>" required>
            <label for="name" class="form-label">Name</label>
            <div class="form-text">
                <p>
                    <small>
                        <%= subcontractor.name %>
                    </small>
                </p>
            </div>
        </div>
        <div class="form-floating mb-3">
            <input type="text" name="company" id="company" class="form-control" value="<%= subcontractor.company %>"
                   required>
            <label for="company" class="form-label">Company</label>
            <div class="form-text">
                <p>
                    <small>
                        <%= subcontractor.company %>
                    </small>
                </p>
            </div>
        </div>
        <div class="form-floating mb-3">
            <input type="text" name="line1" id="line1" class="form-control" value="<%= subcontractor.line1 %>" required>
            <label for="line1" class="form-label">Address Line 1</label>
            <div class="form-text">
                <p>
                    <small>
                        <%= subcontractor.line1 %>
                    </small>
                </p>
            </div>
        </div>
        <div class="form-floating mb-3">
            <input type="text" name="line2" id="line2" class="form-control" value="<%= subcontractor.line2 %>" required>
            <label for="line2" class="form-label">Address Line 2</label>
            <div class="form-text">
                <p>
                    <small>
                        <%= subcontractor.line2 %>
                    </small>
                </p>
            </div>
        </div>
        <div class="form-floating mb-3">
            <input type="text" name="city" id="city" class="form-control" value="<%= subcontractor.city %>" required>
            <label for="city" class="form-label">City</label>
            <div class="form-text">
                <p>
                    <small>
                        <%= subcontractor.city %>
                    </small>
                </p>
            </div>
        </div>
        <div class="form-floating mb-3">
            <input type="text" name="county" id="county" class="form-control" value="<%= subcontractor.county %>" required>
            <label for="county" class="form-label">County</label>
            <div class="form-text">
                <p>
                    <small>
                        <%= subcontractor.county %>
                    </small>
                </p>
            </div>
        </div>
        <div class="form-floating mb-3">
            <input type="text" name="postalCode" id="postalCode" class="form-control"
                   value="<%= subcontractor.postalCode %>" required>
            <label for="postalCode" class="form-label">Postal Code</label>
            <div class="form-text">
                <p>
                    <small>
                        <%= subcontractor.postalCode %>
                    </small>
                </p>
            </div>
        </div>
        <div class="form-floating mb-3">
            <input type="text" name="cisNumber" id="cisNumber" class="form-control" value="<%= subcontractor.cisNumber %>"
                   required>
            <label for="cisNumber" class="form-label">CIS Number</label>
            <div class="form-text">
                <p>
                    <small>
                        <%= subcontractor.cisNumber %>
                    </small>
                </p>
            </div>
        </div>
        <div class="form-floating mb-3">
            <input type="text" name="utrNumber" id="utrNumber" class="form-control" value="<%= subcontractor.utrNumber %>"
                   required>
            <label for="utrNumber" class="form-label">UTR Number</label>
            <div class="form-text">
                <p>
                    <small>
                        <%= subcontractor.utrNumber %>
                    </small>
                </p>
            </div>
        </div>
        <div class="form-floating mb-3">
            <input type="text" name="vatNumber" id="vatNumber" class="form-control" value="<%= subcontractor.vatnumber %>"
                   required>
            <label for="vatNumber" class="form-label">VAT Number</label>
            <div class="form-text">
                <p>
                    <small>
                        <a href="https://find-and-update.company-information.service.gov.uk/company/<%= subcontractor.vatnumber %>"><%= subcontractor.vatnumber %></a>
                    </small>
                </p>
            </div>
        </div>
        <div class="form-floating mb-3">
            <select name="deduction" id="deduction" class="form-select">
                <option value="0.3" <%= subcontractor.deduction = 0.3 ? 'selected' : '' %>>30%</option>
                <option value="0.2" <%= subcontractor.deduction = 0.2 ? 'selected' : '' %>>20%</option>
                <option value="0" <%= subcontractor.deduction = 0 ? 'selected' : '' %>>0%</option>
            </select>
            <label for="deduction" class="form-label">Deduction</label>
            <div class="form-text">
                <p>
                    <small>
                        <%= subcontractor.deduction %>
                    </small>
                </p>
            </div>
        </div>
        <div class="form-floating mb-3">
            <select id="isGross" name="isGross" class="form-select">
                <option value="false" <%= subcontractor.isGross === false ? 'selected' : '' %>>False</option>
                <option value="true" <%= subcontractor.isGross === true ? 'selected' : '' %>>True</option>
            </select>
            <label for="isGross" class="form-label">isGross</label>
            <div class="form-text">
                <p>
                    <small>
                        <%= subcontractor.isGross %>
                    </small>
                </p>
            </div>
        </div>
        <span class="d-flex justify-content-between">
            <button type="submit" class="btn btn-hcs-green">Update Subcontractor</button>
            <a type="button" class="text-hcs-red" data-bs-toggle="modal" data-bs-target="#deleteConfirmationModal">
                Delete Subcontractor
            </a>
        </span>
    </form>
</div>

<!-- Modal -->
<div class="modal fade" id="deleteConfirmationModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Delete Confirmation</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body text-center">
                Are you sure you want to delete this Subcontractor?
                <hr>
                <dl>
                    <dt>Name: </dt>
                    <dd><%= subcontractor.name %></dd>

                    <dt>Company: </dt>
                    <dd><%= subcontractor.company %></dd>

                    <dt>UTR: </dt>
                    <dd><%= subcontractor.utrNumber %></dd>

                    <dt>CIS: </dt>
                    <dd><%= subcontractor.cisNumber %></dd>
                </dl>
                <hr>
                <span class="hcs-red-text lead">This action cannot be undone!</span>
            </div>
            <div class="modal-footer d-flex justify-content-between">
                <form action="/subcontractor/delete/<%= subcontractor.id %>" method="POST">
                    <button type="submit" class="btn btn-hcs-red">Delete</button>
                </form>
                <a type="button" class="text-hcs-black" data-bs-dismiss="modal">Close</a>
            </div>
        </div>
    </div>
</div>